var roles=require("roles"),util=require("util");function creeps_of_role(a){return _.filter(Game.creeps,function(b){return b.memory.role==a})}
function build_creep(a){var b=roles[a].parts;b||(b=roles.default_parts);var c=Game.spawns.Spawn2,d;d=0==c.room.find(FIND_MY_CREEPS).length?c.room.energyAvailable:c.room.energyCapacityAvailable;var e,f;for(f in b){var g=b[f];if(util.body_cost(g)<=d)e=g;else break}e?c.canCreateCreep(e)==OK&&(b=role+Memory.muhid,Memory.muhid++,c.createCreep(e,b,{role:a})):console.log("Part failure: "+a+", budget:"+d)}
module.exports={run:function(){"undefined"==typeof Memory.muhid&&(Memory.muhid=1);for(var a in Memory.creeps)Game.creeps[a]||delete Memory.creeps[a];a=["harvester","cow","upgrader","builder","guard"];var b={harvester:2,cow:4,upgrader:3,builder:3,guard:3},c;for(c in a){var d=a[c];if(creeps_of_role(d).length<b[d]){build_creep(d);break}}}};
