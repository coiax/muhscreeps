var util=require("util");RoomPosition.prototype.ordinals=function(){var a=[new RoomPosition(this.x+1,this.y+1,this.roomName),new RoomPosition(this.x+0,this.y+1,this.roomName),new RoomPosition(this.x-1,this.y+1,this.roomName),new RoomPosition(this.x+1,this.y+0,this.roomName),new RoomPosition(this.x-1,this.y+0,this.roomName),new RoomPosition(this.x+1,this.y-1,this.roomName),new RoomPosition(this.x+0,this.y-1,this.roomName),new RoomPosition(this.x-1,this.y-1,this.roomName)];return _.compact(a)};
RoomPosition.prototype.cardinals=function(){var a=[new RoomPosition(this.x+1,this.y+0,this.roomName),new RoomPosition(this.x-1,this.y+0,this.roomName),new RoomPosition(this.x+0,this.y+1,this.roomName),new RoomPosition(this.x+0,this.y-1,this.roomName)];return _.compact(a)};
RoomPosition.prototype.step=function(a){var c=this.x,b=this.y,d=this.roomName;switch(a){case TOP:b-=1;break;case TOP_RIGHT:c+=1;b-=1;break;case RIGHT:c+=1;break;case BOTTOM_RIGHT:c+=1;b+=1;break;case BOTTOM:b+=1;break;case BOTTOM_LEFT:c-=1;b+=1;break;case LEFT:c-=1;break;case TOP_LEFT:c-=1,b-=1}return new RoomPosition(c,b,d)};RoomPosition.prototype.is_terrain=function(a){var c=this.look(),b;for(b in c){var d=c[b];if("terrain"==d.type&&d.terrain==a)return!0}return!1};
RoomPosition.prototype.is_swamp=function(){return this.is_terrain("swamp")};RoomPosition.prototype.is_wall=function(){return this.is_terrain("wall")};RoomPosition.prototype.is_plain=function(){return is_terrain("plain")};RoomPosition.prototype.non_wall_adjacent=function(){return _.reject(this.ordinals(),function(a){return a.is_wall()})};function memoryPosition(a){return new RoomPosition(a.x,a.y,a.roomName)}
var roleCow={run:function(a){"undefined"==typeof a.room.memory.cows&&(a.room.memory.cows=[]);var c=a.room.memory.cows,b;for(b in c)Game.creeps[b]||delete c[b];if(!a.memory.grazing_spot){var d=[];a.room.find(FIND_SOURCES).forEach(function(a){d=d.concat(a.pos.non_wall_adjacent())});a.memory.grazing_spot=_.sample(d)}if(a.memory.grazing_spot)if(c=memoryPosition(a.memory.grazing_spot))if(c.isEqualTo(a.pos)){if(e=Game.getObjectById(a.memory.flag_id))e.remove(),a.memory.flag_id=void 0;a.memory.output_container_id||
(b=a.pos.findInRange(FIND_MY_STRUCTURES,1,filter=function(a){return a.structureType==STRUCTURE_CONTAINER}),b.length&&(a.memory.output_container_id=b[0].id));a.memory.output_container_id?a.say("nom"):(b=a.pos.findInRange(FIND_MY_CONSTRUCTION_SITES,1,filter=function(a){return a.structureType==STRUCTURE_CONTAINER}),b.length?(c=b[0],a.add_task({type:"construct",target:c.id,resupply:!0})):(c=c.getDirectionTo(a),a.pos.step(c).createConstructionSite(STRUCTURE_CONTAINER)))}else{a.say("moving");a.moveTo(c);
b=a.name+"'s grazing spot";var e=c.createFlag(b,COLOR_GREEN);e==b&&(a.memory.flag_id=Game.flags[b].id)}else a.say("???");else a.say("NOGRASS!")}};module.exports=roleCow;
