var util=require("util");RoomPosition.prototype.ordinals=function(){var b=[new RoomPosition(this.x+1,this.y+1,this.roomName),new RoomPosition(this.x+0,this.y+1,this.roomName),new RoomPosition(this.x-1,this.y+1,this.roomName),new RoomPosition(this.x+1,this.y+0,this.roomName),new RoomPosition(this.x-1,this.y+0,this.roomName),new RoomPosition(this.x+1,this.y-1,this.roomName),new RoomPosition(this.x+0,this.y-1,this.roomName),new RoomPosition(this.x-1,this.y-1,this.roomName)];return _.compact(b)};
RoomPosition.prototype.cardinals=function(){var b=[new RoomPosition(this.x+1,this.y+0,this.roomName),new RoomPosition(this.x-1,this.y+0,this.roomName),new RoomPosition(this.x+0,this.y+1,this.roomName),new RoomPosition(this.x+0,this.y-1,this.roomName)];return _.compact(b)};
RoomPosition.prototype.step=function(b){var a=this.x,c=this.y,d=this.roomName;switch(b){case TOP:c-=1;break;case TOP_RIGHT:a+=1;c-=1;break;case RIGHT:a+=1;break;case BOTTOM_RIGHT:a+=1;c+=1;break;case BOTTOM:c+=1;break;case BOTTOM_LEFT:a-=1;c+=1;break;case LEFT:a-=1;break;case TOP_LEFT:a-=1,c-=1}return new RoomPosition(a,c,d)};RoomPosition.prototype.is_terrain=function(b){var a=this.look(),c;for(c in a){var d=a[c];if("terrain"==d.type&&d.terrain==b)return!0}return!1};
RoomPosition.prototype.is_swamp=function(){return this.is_terrain("swamp")};RoomPosition.prototype.is_wall=function(){return this.is_terrain("wall")};RoomPosition.prototype.is_plain=function(){return is_terrain("plain")};RoomPosition.prototype.non_wall_adjacent=function(){return _.reject(this.ordinals(),function(b){return b.is_wall()})};function memoryPosition(b){return b?new RoomPosition(b.x,b.y,b.roomName):null}
var roleCow={run:function(b){var a=Game.getObjectById(b.memory.source_id);if(!a&&(a=b.room.find(FIND_SOURCES),a=_.sample(a)))b.memory.source_id=a.id;var c=memoryPosition(b.memory.pasture_loc);c||(c=_.sample(a.pos.non_wall_adjacent()),b.memory.pasture_loc=c);_.includes(a.pos.non_wall_adjacent(),c)?c.isEqualTo(b.pos)?(a=Game.getObjectById(b.memory.output_container_id),a||(c=b.pos.findInRange(FIND_MY_STRUCTURES,1,filter=function(a){return a.structureType==STRUCTURE_CONTAINER}),c.length&&(a=c[0],b.memory.output_container_id=
a.id)),a?b.say("nom"):(a=b.pos.findInRange(FIND_MY_CONSTRUCTION_SITES,1,filter=function(a){return a.structureType==STRUCTURE_CONTAINER}),a.length?(a=a[0],b.add_task({type:"construct",target:a.id,resupply:!0})):(a=gs.getDirectionTo(b),b.pos.step(a).createConstructionSite(STRUCTURE_CONTAINER)))):b.moveTo(c):(b.say("!ploc"),b.memory.debug_bad_pasture_loc=c,b.memory.pasture_loc=null)}};module.exports=roleCow;
