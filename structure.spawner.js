var roles=require("roles"),util=require("util");
function build_creep(b,f){var d=roles.default_parts,a=Game.spawns.Spawn2,c;c=0==a.room.find(FIND_MY_CREEPS).length?a.room.energyAvailable:a.room.energyCapacityAvailable;var e,g;for(g in d){var h=d[g];if(util.body_cost(h)<=c)e=h;else break}if(e){for(d=f.replace(".","_")+b.creep_id;!(c=a.canCreateCreep(e,d),c==OK);)if(c==ERR_NAME_EXISTS)b.creep_id++;else return;b.creep_id++;a.createCreep(e,d,{task_queue:[{type:f}]})}else console.log("Part failure: "+role_name+", budget:"+c)}
function setup(b){"undefined"==typeof b.creep_id&&(b.creep_id=1)}
module.exports={name:"structure.spawner",run:function(b,f){setup(b);counts={};required=[{task:"role.supplier",amount:1},{task:"role.cow",amount:1},{task:"role.upgrader",amount:1},{task:"role.builder",amount:1},{task:"role.cow",amount:2},{task:"role.supplier",amount:2},{task:"role.cow",amount:3},{task:"role.supplier",amount:3},{task:"role.cow",amount:4},{task:"role.supplier",amount:4},{task:"role.upgrader",amount:3},{task:"role.builder",amount:4},{task:"role.guard",amount:3}];for(var d in required){var a=
required[d];if(!counts[a.task]){var c=util.get_creeps_with_task(a.task);counts[a.task]=c.length}if(counts[a.task]<a.amount){build_creep(b,a.task);break}}return{outcome:"continue"}}};require("task_manager").register(module.exports.name,module.exports.run);
