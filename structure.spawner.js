var util=require("util");function generate_default_parts(){for(var b=1;;){for(var c=[],a=0;a<b;a++)c.push(WORK);for(a=0;a<b;a++)c.push(CARRY);for(a=0;a<b;a++)c.push(MOVE);if(50>=c.length)default_parts.push(c),b++;else break}}var default_parts=[];generate_default_parts();
function build_creep(b,c,a){var d,e;c.currently_attempting=a;try{e=require(a)}catch(f){console.log("Error importing task '"+a+"': "+f)}d=default_parts;e&&e.parts&&(d=e.parts);e=b.room.energyAvailable;var g,h;for(h in d){var k=d[h];if(util.body_cost(k)<=e)g=k;else break}if(g){for(d=a.replace(".","_")+c.creep_id;;)if(h=b.canCreateCreep(g,d),h==OK){c.currently_spawning=a;break}else if(h==ERR_NAME_EXISTS)c.creep_id++;else return;c.creep_id++;b.createCreep(g,d,{task_queue:[{type:a}],support:b.name});b.support_creep(Game.creeps[d])}}
function setup(b,c){"undefined"==typeof b.creep_id&&(b.creep_id=1);b.currently_attempting=null;c.spawning||(b.currently_spawning=null)}
module.exports={name:"structure.spawner",run:function(b,c){setup(b,c);c.check_creeps();var a={},d=[{task:"role.supplier",amount:1},{task:"role.cow",amount:1},{task:"role.upgrader",amount:1},{task:"role.builder",amount:1},{task:"role.cow",amount:2},{task:"role.supplier",amount:2},{task:"role.cow",amount:3},{task:"role.supplier",amount:3},{task:"role.cow",amount:4},{task:"role.supplier",amount:4},{task:"role.upgrader",amount:3},{task:"role.builder",amount:4},{task:"role.dumbscout",amount:10},{task:"role.claimer",
amount:1}],e;for(e in d){var f=d[e];if(!a[f.task]){var g=util.get_creeps_with_task(f.task);a[f.task]=g.length}if(a[f.task]<f.amount){build_creep(c,b,f.task);break}}return{outcome:"continue"}}};require("task_manager").register(module.exports.name,module.exports.run);
