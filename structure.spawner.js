var roles=require("roles"),util=require("util");function count_creeps_with_task(b){var d=[],a;for(a in Game.creeps){var c=Game.creeps[a];c.has_task_in_queue(b)&&d.push(c)}return d}
function build_creep(b,d){var a=roles.default_parts,c=Game.spawns.Spawn2,f;f=0==c.room.find(FIND_MY_CREEPS).length?c.room.energyAvailable:c.room.energyCapacityAvailable;var e,g;for(g in a){var h=a[g];if(util.body_cost(h)<=f)e=h;else break}e?c.canCreateCreep(e)==OK&&(a=role_name+b.creep_id,b.creep_id++,c.createCreep(e,a,{task_queue:[{type:d}]})):console.log("Part failure: "+role_name+", budget:"+f)}function setup(b){"undefined"==typeof b.creep_id&&(b.creep_id=1)}
module.exports={name:"structure.spawner",run:function(b,d){setup(b);counts={};required=[{task:"role.supplier",amount:1},{task:"role.cow",amount:1},{task:"role.upgrader",amount:1},{task:"role.builder",amount:1},{task:"role.cow",amount:2},{task:"role.supplier",amount:2},{task:"role.cow",amount:3},{task:"role.supplier",amount:3},{task:"role.cow",amount:4},{task:"role.supplier",amount:4},{task:"role.upgrader",amount:3},{task:"role.builder",amount:4},{task:"role.guard",amount:3}];for(var a in required){a=
required[a];counts[a.task]||(counts[a.task]=count_creeps_with_task(a.task));counts[a.task]<a.amount&&build_creep(b,a.task);break}return{outcome:"continue"}}};require("task_manager").register(module.exports.name,module.exports.run);
