var roles=require("roles"),util=require("util");
function build_creep(b,f){var a=roles.default_parts,c=Game.spawns.Spawn2,d;d=0==c.room.find(FIND_MY_CREEPS).length?c.room.energyAvailable:c.room.energyCapacityAvailable;var e,g;for(g in a){var h=a[g];if(util.body_cost(h)<=d)e=h;else break}if(e){for(a=f+b.creep_id;!(d=c.canCreateCreep(e,a),d==OK);)if(d==ERR_NAME_EXISTS)b.creep_id++;else return;b.creep_id++;c.createCreep(e,a,{task_queue:[{type:f}]})}else console.log("Part failure: "+role_name+", budget:"+d)}
function setup(b){"undefined"==typeof b.creep_id&&(b.creep_id=1)}
module.exports={name:"structure.spawner",run:function(b,f){setup(b);counts={};required=[{task:"role.supplier",amount:1},{task:"role.cow",amount:1},{task:"role.upgrader",amount:1},{task:"role.builder",amount:1},{task:"role.cow",amount:2},{task:"role.supplier",amount:2},{task:"role.cow",amount:3},{task:"role.supplier",amount:3},{task:"role.cow",amount:4},{task:"role.supplier",amount:4},{task:"role.upgrader",amount:3},{task:"role.builder",amount:4},{task:"role.guard",amount:3}];for(var a in required){a=
required[a];if(!counts[a.task])var c=util.get_creeps_with_task(a.task);counts[a.task]=c.length;counts[a.task]<a.amount&&build_creep(b,a.task);break}return{outcome:"continue"}}};require("task_manager").register(module.exports.name,module.exports.run);
